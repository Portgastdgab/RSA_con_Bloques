#include "RSA/RSA.h"


/*
int main() {

    RSA receptor(512);                         //El receptor indica el numero de bits para generar claves
    RSA emisor(receptor.e, receptor.n); //El emisor que mandara los mensajes recibe las claves generadas
//    ZZ p = conv <ZZ> ("83618702482976873355419185741462327875394103316198637477777483049307926570473");
//    ZZ q = conv <ZZ> ("105251049421353313181103190131801353996604096101813730606770075755135246197629");
//    ZZ d = conv <ZZ> ("1840309856668376933155638126995080591304945663816041708759107639748208699708507221084087039405244171513435949567557741301913484953316478635155617379020193");
//    ZZ n = conv <ZZ> ("8800956187585237898505264599051143886382655083622737613367702104247583660916386270531869215664928173069596422233627744177103019346052453570741411554008517");
//    RSA receptor(p, q, d, n);
//    string cypher_message = "5291702368152087946076128350432133427619525644298358252989305580235335472718400325939467290944651759621145206963744475018767935489489438378791860426419490197937641227105068882137173072937851857430981159166177802494567096737048984940043528326672459465320226996807863483254660570006640477939003067967297731928175392890206820780754793505698746101272516614468354217634105901309538335406749099576339331890281877002949277657658392977918229586006559375922531178841503428584042496723812467183803957607016485059533894571648395275679285395066018510101362451969731433823407933118497354126279184787599862182751028340925498442846";
    emisor.message = "algebraabstracta";       //El emisor escribe su mensaje
    emisor.cipher(emisor.blocks(emisor.message));              //El emisor cifra su mensaje, el cifrado se almacena en el atributo crypted letter
    receptor.decipher(emisor.crypted_letter);   //El receptor decifra el mensaje
//    receptor.decipher(cypher_message);
    emisor.show_encryption();                   //Muestra el cifrado almacenado en crypted_letter
    receptor.show_decryption();                 //Muestra el decifrado almacenado en message

    return 0;
}
*/



int main(){
    string firmaDescifrada,firmaCifrada;

//    RSA emisor(512);
//    emisor.n = 34393;
//    emisor.e=253;
//    emisor.d=2017;
//    RSA receptor(100);
//    receptor.n=1961;
//    receptor.e=19;
//    receptor.d=1675;
//
////    ZZ n=conv<ZZ>("20277370801534753382821495234035442778757233211149233976452120434498427529417478936875636128572693669839972760569823589404192675733413974188225200810716907021608624612238795357280565658889717043523184383596752027193819824395447529305703710088880825066002165845549446678712742470072857671296268420261721444445806651323707106502601039431210025525114717819062221823249993385919193720283239311955267970138683736214514761066627997906996778610251210071716344470434314292629140027935293228037870054248601601347977896522508058149756472905662464571594008775790203314997865551235637247379131492251390183445834245020667545805717");
////    ZZ e=conv<ZZ>("93143256852327905541154997250672662111591254628363132554785588965138784497734137671290648112252499847254417427895517800380514979908224171216227175519946546390917746106580710819656970760250121608762131666378389468604814416798074624061051160198354226696224926445834891783014316747545909563807660165959137908331");
//
//    //Emisor
//    firmaCifrada=emisor.firmaCipher("hola",receptor.e,receptor.n);
//    cout<<"\nfirma Cifrada: "<<firmaCifrada;
//
//
//    //Receptor
//
//    firmaDescifrada=receptor.firmaDecipher(firmaCifrada,emisor.e,emisor.n);
//    cout<<"\nfirma Decifrada: "<< firmaDescifrada;


    RSA emisor(500);
    RSA receptor(100);

    ZZ e,n;

    cout<<"er: ";cin>>e;
    cout<<"nr: ";cin>>n;

    e = receptor.e;
    n = receptor.n;

    string msj = "hola mundo";


    //Emisor
    firmaCifrada=emisor.firmaCipher(msj,e,n);
    cout<<"\nfirma Cifrada: "<<firmaCifrada;









}


